"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2233],{50076:(I,P,c)=>{c.d(P,{oK:()=>n,GW:()=>b,dk:()=>f});var n=(()=>{return(o=n||(n={})).Prompt="PROMPT",o.Camera="CAMERA",o.Photos="PHOTOS",n;var o})(),b=(()=>{return(o=b||(b={})).Rear="REAR",o.Front="FRONT",b;var o})(),f=(()=>{return(o=f||(f={})).Uri="uri",o.Base64="base64",o.DataUrl="dataUrl",f;var o})()},26388:(I,P,c)=>{c.d(P,{dk:()=>b.dk,oK:()=>b.oK,V1:()=>f});var n=c(47423),b=c(50076);const f=(0,n.fo)("Camera",{web:()=>c.e(3954).then(c.bind(c,63954)).then(o=>new o.CameraWeb)})},2233:(I,P,c)=>{c.r(P),c.d(P,{frmtareasprogramadasCreatePageModule:()=>D});var n=c(23349),b=c(55787),f=c(69808),o=c(33678),M=c(51062),_=c(93075),y=c(36351),A=c(70655),U=c(68554),l=c(63814),p=c(15190),Z=c(26388),t=c(5e3);const F=["inputId"],N=["fotoa"];function E(u,v){if(1&u&&t._UZ(0,"ion-img",29),2&u){const e=t.oxw().$implicit,i=t.oxw();t.Q6J("src",i.apifoto+e.foto)}}const w=function(){return{standalone:!0}};function L(u,v){if(1&u){const e=t.EpF();t.TgZ(0,"ion-item",25),t.TgZ(1,"ion-row"),t.TgZ(2,"ion-col",26),t.YNc(3,E,1,1,"ion-img",27),t.qZA(),t.TgZ(4,"ion-col"),t.TgZ(5,"strong"),t._uU(6,"No:"),t.qZA(),t._uU(7),t._UZ(8,"br"),t.TgZ(9,"strong"),t._uU(10,"Nombre:"),t.qZA(),t._uU(11),t._UZ(12,"br"),t.TgZ(13,"strong"),t._uU(14,"CUI:"),t.qZA(),t._uU(15),t._UZ(16,"br"),t.TgZ(17,"strong"),t._uU(18,"CARGO:"),t.qZA(),t._uU(19),t._UZ(20,"br"),t.TgZ(21,"strong"),t._uU(22,"Estado:"),t.qZA(),t._uU(23),t._UZ(24,"br"),t.qZA(),t.qZA(),t.TgZ(25,"ion-toggle",28),t.NdJ("ngModelChange",function(a){return t.CHM(e).$implicit.isChecked=a})("ionChange",function(){return t.CHM(e),t.oxw().checkEvent1()}),t.qZA(),t.qZA()}if(2&u){const e=v.$implicit,i=v.index;t.xp6(3),t.Q6J("ngIf",void 0!==e.foto),t.xp6(4),t.hij(" ",i+1,""),t.xp6(4),t.hij(" ",e.nombre,""),t.xp6(4),t.hij(" ",e.cui," "),t.xp6(4),t.hij(" ",e.cargo," "),t.xp6(4),t.hij(" ",e.estado," "),t.xp6(2),t.Q6J("ngModel",e.isChecked)("ngModelOptions",t.DdM(8,w))}}function B(u,v){if(1&u){const e=t.EpF();t.TgZ(0,"ion-item",25),t.TgZ(1,"ion-row"),t.TgZ(2,"ion-col"),t.TgZ(3,"strong"),t._uU(4,"No:"),t.qZA(),t._uU(5),t._UZ(6,"br"),t.TgZ(7,"strong"),t._uU(8,"Marca:"),t.qZA(),t._uU(9),t._UZ(10,"br"),t.TgZ(11,"strong"),t._uU(12,"Modelo:"),t.qZA(),t._uU(13),t._UZ(14,"br"),t.TgZ(15,"strong"),t._uU(16,"No Chasis:"),t.qZA(),t._uU(17),t._UZ(18,"br"),t.TgZ(19,"strong"),t._uU(20,"Piloto:"),t.qZA(),t._uU(21),t._UZ(22,"br"),t.TgZ(23,"strong"),t._uU(24,"Tipo:"),t.qZA(),t._uU(25),t._UZ(26,"br"),t.TgZ(27,"strong"),t._uU(28,"Estado:"),t.qZA(),t._uU(29),t._UZ(30,"br"),t.qZA(),t.qZA(),t.TgZ(31,"ion-toggle",28),t.NdJ("ngModelChange",function(a){return t.CHM(e).$implicit.isChecked=a})("ionChange",function(){return t.CHM(e),t.oxw().checkEvent3()}),t.qZA(),t.qZA()}if(2&u){const e=v.$implicit,i=v.index;t.xp6(5),t.hij(" ",i+1,""),t.xp6(4),t.hij(" ",e.modelo,""),t.xp6(4),t.hij(" ",e.modelo," "),t.xp6(4),t.hij(" ",e.nochasis," "),t.xp6(4),t.hij(" ",e.piloto," "),t.xp6(4),t.hij(" ",e.tipo," "),t.xp6(4),t.hij(" ",e.estado," "),t.xp6(2),t.Q6J("ngModel",e.isChecked)("ngModelOptions",t.DdM(9,w))}}function S(u,v){if(1&u){const e=t.EpF();t.TgZ(0,"ion-item",25),t.TgZ(1,"ion-row"),t.TgZ(2,"ion-col"),t.TgZ(3,"strong"),t._uU(4,"No:"),t.qZA(),t._uU(5),t._UZ(6,"br"),t.TgZ(7,"strong"),t._uU(8,"Descripcion:"),t.qZA(),t._uU(9),t._UZ(10,"br"),t.TgZ(11,"strong"),t._uU(12,"Tipo:"),t.qZA(),t._uU(13),t._UZ(14,"br"),t.TgZ(15,"strong"),t._uU(16,"Cantidad:"),t.qZA(),t._uU(17),t._UZ(18,"br"),t.TgZ(19,"strong"),t._uU(20,"Estado:"),t.qZA(),t._uU(21),t._UZ(22,"br"),t.qZA(),t.qZA(),t.TgZ(23,"ion-toggle",28),t.NdJ("ngModelChange",function(a){return t.CHM(e).$implicit.isChecked=a})("ionChange",function(){return t.CHM(e),t.oxw().checkEvent2()}),t.qZA(),t.qZA()}if(2&u){const e=v.$implicit,i=v.index;t.xp6(5),t.hij(" ",i+1,""),t.xp6(4),t.hij(" ",e.descripcion,""),t.xp6(4),t.hij(" ",e.tipo," "),t.xp6(4),t.hij(" ",e.cantidad," "),t.xp6(4),t.hij(" ",e.estado," "),t.xp6(2),t.Q6J("ngModel",e.isChecked)("ngModelOptions",t.DdM(7,w))}}function R(u,v){if(1&u){const e=t.EpF();t.TgZ(0,"ion-col",30),t.TgZ(1,"ion-button",31),t.NdJ("click",function(){return t.CHM(e),t.oxw().submitForm()}),t._uU(2,"ACTUALIZAR VISITA"),t.qZA(),t.qZA()}if(2&u){const e=t.oxw();t.Q6J("hidden",!e.esinspector),t.xp6(1),t.Q6J("disabled",!e.Form.valid)}}let j=(()=>{class u{constructor(e,i,a,s,h,T,d){this.location=e,this.router=i,this.alertController=a,this.modalController=s,this.translateService=h,this.authenticationService=T,this.actionSheetController=d,this.variables=[],this.userinfo=[],this.tituloxx="",this.seguro="",this.msg="",this.submitted=[],this.vgrupo=[],this.checkBoxList1=[],this.checkBoxList2=[],this.checkBoxList3=[],this.finalizatt=0,this.regperosnalempresa=[],this.regperosnalempresa2=[],this.regperosnalempresa3=[],this.essupervisor=!1,this.esinspector=!1,this.apifoto=this.authenticationService.getapifoto()}dacantidadh(e,i){for(let s=0;s<i.length;s++){const h=i[s];if(h.split(",")[0].trim()===e)return h.split(",")[1].split(":")[1].trim()}return"0"}ngAfterViewInit(){}dismissModal(){this.modalController.dismiss("close")}ionViewDidEnter(){}ngOnInit(){this.variables=this.router.getCurrentNavigation().extras.state.variables,this.userinfo=this.router.getCurrentNavigation().extras.state.userinfo,this.idllave=this.router.getCurrentNavigation().extras.state.idllave,this.tituloxx=this.router.getCurrentNavigation().extras.state.title,this.itemactual=this.router.getCurrentNavigation().extras.state.record,this.tipojornada=this.router.getCurrentNavigation().extras.state.tipojornada,this.geoposiciontxt=this.router.getCurrentNavigation().extras.state.geoposiciontxt,this.translateService.get("SEGUROM").subscribe(e=>{this.seguro=e}),this.translateService.get("MSGM").subscribe(e=>{this.msg=e}),this.inspector=this.router.getCurrentNavigation().extras.state.record.idinspector,this.supervisor=this.router.getCurrentNavigation().extras.state.record.idsupervisor,this.Form=new _.cw({comentarioherramientas:new _.NI(""),comentariopersonas:new _.NI(""),comentariovehiculos:new _.NI(""),personas1:new _.NI(""),personas2:new _.NI(""),personas3:new _.NI("")}),this.authenticationService.getReg("5f58197323db5a1bdc6591cas/"+this.itemactual.idempresa0+"/"+this.userinfo[0].idempresa._id+"\xb05f58197323db5a1bdc6591ca/unregistromovil","frmmovils",0).then(e=>{this.correo2=e.correoelectronico}),this.authenticationService.getReg(this.itemactual.idsupervisor+"/emailsoloidnuevo/"+this.userinfo[0].idempresa._id,"personals",0).then(e=>{this.correo1=e[0].email},e=>{this.authenticationService.presentAlert(e.error,"Precauci\xf3n","")}),this.authenticationService.getReg(this.itemactual.idinspector+"/emailsoloidnuevo/"+this.userinfo[0].idempresa._id,"personals",0).then(e=>{this.correo3=e[0].email},e=>{this.authenticationService.presentAlert(e.error,"Precauci\xf3n","")}),"Supervisor planificaci\xf3n"===this.userinfo[0].role?(this.essupervisor=!0,this.esinspector=!1):(this.esinspector=!0,this.essupervisor=!1),this.estadoxxx=this.itemactual.estado,!0===this.essupervisor&&"autorizar"===this.estadoxxx&&(this.finalizatt=1),!0===this.esinspector&&"activa"===this.estadoxxx&&(this.finalizatt=1),this.itemactual.verificapersonal&&(this.regperosnal2=this.itemactual.verificapersonal.indexOf(";")>0?this.itemactual.verificapersonal.split(";"):[]),this.itemactual.verificavehiculos&&(this.regvehiculos2=this.itemactual.verificavehiculos.indexOf(";")>0?this.itemactual.verificavehiculos.split(";"):[]),this.itemactual.verificaherramienta&&(this.regherramienta2=this.itemactual.verificaherramienta.indexOf(";")>0?this.itemactual.verificaherramienta.split(";"):[]),void 0===this.regvehiculos2&&(this.regvehiculos2=[]),void 0===this.regperosnal2&&(this.regperosnal2=[]),void 0===this.regherramienta2&&(this.regherramienta2=[]),this.authenticationService.getReg("5f73dd0f8c88964b5cb326cbs/"+this.itemactual.idempresa0+"/"+this.userinfo[0].idempresa._id+"\xb05f73dd0f8c88964b5cb326cb/registromovilxidpapa","frmmovils",0).then(e=>{var i;i=e;var a=e[0]._id;for(let s=0;s<i.length;s++)if(String(i[s].contrato).indexOf(this.itemactual.idcontrato)>=0){a=e[s]._id;break}this.authenticationService.getReg("5f729c2487c9e33bd4ada798/"+this.itemactual.idcontrato+"/"+this.userinfo[0].idempresa._id+"\xb05f729c2487c9e33bd4ada798/unregistromovil","frmmovils",0).then(s=>{this.contratov=s;const h=s;String(h.recursopersonas).indexOf("\xac")>=0&&h.recursopersonas.split("\xac"),this.authenticationService.getReg("5f763557d10b6816041c2ed4/"+a+"/"+this.userinfo[0].idempresa._id+"\xb05f763557d10b6816041c2ed4/registromovilxidpapa","frmmovils",0).then(d=>{var C;C=d;var x="";for(let m=0;m<C.length;m++)this.tipojornada===C[m].jornada&&(x=x+String(C[m].peronals).split("\xac")[1]+"\xb0;");this.regperosnalempresa=[],this.authenticationService.getReg("5f595d6d2521cd38c8fe311ds/"+x+"/"+this.userinfo[0].idempresa._id+"\xb05f595d6d2521cd38c8fe311d/arrayregistromovil","frmmovils",0).then(m=>{this.regperosnalempresa=m,this.regperosnal=m;for(let r=0;r<this.regperosnal.length;r++){let g=0;for(let k=0;k<this.regperosnal2.length;k++)if(this.regperosnal2[k]===this.regperosnal[r]._id){g=1;break}this.checkBoxList1.push(0===g?{_id:this.regperosnal[r]._id,nombre:this.regperosnal[r].nombres+" "+this.regperosnal[r].apellidos,foto:this.regperosnal[r].fotografiadelempleado,cargo:this.regperosnal[r].cargo,estado:this.regperosnal[r].estado,cui:this.regperosnal[r].cui,isChecked:!1}:{_id:this.regperosnal[r]._id,nombre:this.regperosnal[r].nombres+" "+this.regperosnal[r].apellidos,foto:this.regperosnal[r].fotografiadelempleado,cargo:this.regperosnal[r].cargo,cui:this.regperosnal[r].cui,estado:this.regperosnal[r].estado,isChecked:!0})}})}),this.authenticationService.getReg("5f764a6d7e8d091240017ccfs/"+a+"/"+this.userinfo[0].idempresa._id+"\xb05f764a6d7e8d091240017ccf/registromovilxidpapa","frmmovils",0).then(d=>{var C;C=d;var x="";for(let m=0;m<C.length;m++)x=x+String(C[m].vehiculos).split("\xac")[1]+"\xb0;";this.regperosnalempresa2=[],this.authenticationService.getReg("5f595d952521cd38c8fe3120/"+x+"/"+this.userinfo[0].idempresa._id+"\xb05f595d952521cd38c8fe3120/arrayregistromovil","frmmovils",0).then(m=>{this.regperosnalempresa2=m,this.regvehiculos=m;for(let r=0;r<this.regvehiculos.length;r++){let g=0;for(let k=0;k<this.regvehiculos2.length;k++)if(this.regvehiculos2[k]===this.regvehiculos[r]._id){g=1;break}this.checkBoxList3.push(0===g?{_id:this.regvehiculos[r]._id,marca:this.regvehiculos[r].marca,modelo:this.regvehiculos[r].modelo,estado:this.regvehiculos[r].estado,nochasis:this.regvehiculos[r].nochasis,piloto:this.regvehiculos[r].piloto,tipo:this.regvehiculos[r].tipo,isChecked:!1}:{_id:this.regvehiculos[r]._id,marca:this.regvehiculos[r].marca,modelo:this.regvehiculos[r].modelo,estado:this.regvehiculos[r].estado,nochasis:this.regvehiculos[r].nochasis,piloto:this.regvehiculos[r].piloto,tipo:this.regvehiculos[r].tipo,isChecked:!0})}})}),this.authenticationService.getReg("5f764af27e8d091240017cd9/"+a+"/"+this.userinfo[0].idempresa._id+"\xb05f764af27e8d091240017cd9/registromovilxidpapa","frmmovils",0).then(d=>{var C;C=d;var x="";for(let m=0;m<C.length;m++)x=x+String(C[m].herramienta).split("\xac")[1]+"\xb0;";this.regperosnalempresa3=[],this.authenticationService.getReg("5f595da82521cd38c8fe3123/"+x+"/"+this.userinfo[0].idempresa._id+"\xb05f595da82521cd38c8fe3123/arrayregistromovil","frmmovils",0).then(m=>{this.regperosnalempresa3=m,this.regherramienta=m;var r=[];String(h.recursodeherramientas).indexOf("\xac")>=0&&(h.recursodeherramientas.split("\xac"),r=h.recursodeherramientas.split("\xac")[1].split(";"));for(let g=0;g<this.regherramienta.length;g++){let k=0;for(let q=0;q<this.regherramienta2.length;q++)if(this.regherramienta2[q]===this.regherramienta[g]._id){k=1;break}this.checkBoxList2.push(0===k?{_id:this.regherramienta[g]._id,estado:this.regherramienta[g].estado,descripcion:this.regherramienta[g].descripcion,tipo:this.regherramienta[g].tipo,cantidad:this.dacantidadh(this.regherramienta[g]._id,r),isChecked:!1}:{_id:this.regherramienta[g]._id,estado:this.regherramienta[g].estado,descripcion:this.regherramienta[g].descripcion,tipo:this.regherramienta[g].tipo,cantidad:this.dacantidadh(this.regherramienta[g]._id,r),isChecked:!0})}})})},s=>{this.authenticationService.presentAlert(s.error,"Precauci\xf3n","")})}),null==this.itemactual?this.translateService.get("NUEVOM").subscribe(e=>{this.tituloxx=e+" "+this.tituloxx,this.lpermiso=e}):(this.translateService.get("ACTUALIZAM").subscribe(e=>{this.tituloxx=e+" "+this.tituloxx,this.lpermiso=e}),this._ID=this.itemactual._id),this.itemactual.comentariopersonal&&this.Form.controls.comentariopersonas.setValue(this.itemactual.comentariopersonal),this.itemactual.comentariovehiculos&&this.Form.controls.comentariovehiculos.setValue(this.itemactual.comentariovehiculos),this.itemactual.comentarioherramienta&&this.Form.controls.comentarioherramientas.setValue(this.itemactual.comentarioherramienta)}submitForm(){this.submitForm0(this.itemactual.estado)}dacomponente(e,i){return(0,A.mG)(this,void 0,void 0,function*(){let a="";"ubicacion"===e&&(a=this.Form.controls.ubicacion.value);const s=yield this.modalController.create({component:l.B,swipeToClose:!1,backdropDismiss:!1,animated:!0,presentingElement:yield this.modalController.getTop(),componentProps:{variables:this.variables,record:null,userinfo:this.userinfo,uubx:a}});return s.onWillDismiss().then(h=>{"close"===h.data||("direccion"===e?this.Form.controls.direccion.setValue(h.data.direccion):this.Form.controls.ubicacion.setValue(h.data.direccion+" {"+h.data.la+"\xb0"+h.data.lo+"}"))}),yield s.present()})}takePicture(e){return(0,A.mG)(this,void 0,void 0,function*(){const i=yield Z.V1.getPhoto({correctOrientation:!0,height:200,width:200,quality:60,allowEditing:!0,resultType:Z.dk.DataUrl,source:Z.oK.Camera});this.authenticationService.generateFromImage(i.dataUrl,200,200,.5,a=>{"fotoa"===e&&(this.fotoimg=a,this.Form.controls.foto.setValue(this.authenticationService.procesafoto(this.Form.controls.foto.value)))})})}uploadPWA2(e,i){i&&i.length>0&&this.firstFileToBase64(i[0]).then(s=>{this.authenticationService.generateFromImage(s,200,300,.5,h=>{"fotoa"===e&&(this.fotoimg=h,this.Form.controls.foto.setValue(this.authenticationService.procesafoto(this.Form.controls.foto.value)))})},s=>{"fotoa"===e&&(this.fotoimg=null,this.Form.controls.foto1.setValue(""))})}uploadPWA(e){if("fotoa"===e){if(null==this.fotoa)return;this.uploadPWA2(e,this.fotoa.nativeElement.files)}}firstFileToBase64(e){return new Promise((i,a)=>{const s=new FileReader;s&&null!=e?(s.readAsDataURL(e),s.onload=()=>{i(s.result)},s.onerror=h=>{a(h)}):a(new Error("No file found"))})}takePicture2(e){return(0,A.mG)(this,void 0,void 0,function*(){"fotoa"===e&&this.fotoa.nativeElement.click()})}fotodatos(e){return(0,A.mG)(this,void 0,void 0,function*(){yield(yield this.actionSheetController.create({header:"Foto",cssClass:"my-custom-class",buttons:[{text:"Galeria",role:"destructive",icon:"image-outline",handler:()=>{this.takePicture2(e)}},{text:"Camara",icon:"camera-outline",handler:()=>{this.takePicture(e)}}]})).present()})}combodatos(e,i,a,s,h,T){return(0,A.mG)(this,void 0,void 0,function*(){const d=yield this.modalController.create({component:p.j,swipeToClose:!1,backdropDismiss:!1,animated:!0,presentingElement:yield this.modalController.getTop(),componentProps:{grabax:T,variables:this.variables,userinfo:this.userinfo,record2:null,op:i,frm:a,idllave:this.idllave,titlex:"Buscar "+h}});return d.onWillDismiss().then(C=>{let x=[];x=C,"close"!==x.data&&this.Form.controls[s].setValue(x.data?x.data.nombre:"")}),yield d.present()})}recursos(e){}checkEvent1(){const e=this.checkBoxList1.length;let i=0;this.checkBoxList1.map(a=>{a.isChecked&&i++}),i>0&&i<e?(this.isIndeterminate1=!0,this.masterCheck1=!1):i==e?(this.masterCheck1=!0,this.isIndeterminate1=!1):(this.isIndeterminate1=!1,this.masterCheck1=!1)}selectitem1(e){let a="";for(let T=0;T<this.checkBoxList1.length;T++)!0===this.checkBoxList1[T].isChecked&&(a=a+";"+this.checkBoxList1[T]._id)}checkEvent2(){const e=this.checkBoxList2.length;let i=0;this.checkBoxList2.map(a=>{a.isChecked&&i++}),i>0&&i<e?(this.isIndeterminate2=!0,this.masterCheck2=!1):i==e?(this.masterCheck2=!0,this.isIndeterminate2=!1):(this.isIndeterminate2=!1,this.masterCheck2=!1)}checkEvent3(){const e=this.checkBoxList3.length;let i=0;this.checkBoxList3.map(a=>{a.isChecked&&i++}),i>0&&i<e?(this.isIndeterminate3=!0,this.masterCheck3=!1):i==e?(this.masterCheck3=!0,this.isIndeterminate3=!1):(this.isIndeterminate3=!1,this.masterCheck3=!1)}fotovisita(){this.router.navigate(["frmtareasprogramadasfotosListPage"],{state:{variables:this.variables,user:null,idllave:this.itemactual._id,title:"Anomalias",geoposiciontxt:this.geoposiciontxt,essupervisor:this.essupervisor,esinspector:this.esinspector,estadoxxx:this.estadoxxx}})}serviciovisita(){this.router.navigate(["frmtareasprogramadasserviciosListPage"],{state:{variables:this.variables,user:null,idempresita:this.itemactual.idproyecto,proyectotxt:" <h1>Fecha programada:"+this.itemactual.fechaasignada+" </h1> <br>  <h1>Estado: "+this.itemactual.estado+" </h1><br><p>No visita:"+this.itemactual.novisita+"<br></p>"+this.itemactual.nombre,idllave:this.itemactual._id,title:"Ordenes de campo",datareg:this.itemactual,geoposiciontxt:this.geoposiciontxt,idsupervisor:this.itemactual.idsupervisor,idinspector:this.itemactual.idinspector,correos:this.correo1+";"+this.correo2+";"+this.correo3,essupervisor:this.essupervisor,esinspector:this.esinspector,estadoxxx:this.estadoxxx}})}autorizar(){return(0,A.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:this.seguro,message:"",buttons:[{text:"No",cssClass:"secondary",handler:i=>{}},{text:"Si",handler:()=>{this.submitForm0("autorizar")}}]})).present()})}finalizar(){return(0,A.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:this.seguro,message:"",buttons:[{text:"No",cssClass:"secondary",handler:i=>{}},{text:"Si",handler:()=>{this.submitForm0("finalizada")}}]})).present()})}submitForm0(e){let i="",a="",s="";for(let d=0;d<this.checkBoxList1.length;d++)this.checkBoxList1[d].isChecked&&(i=i+this.checkBoxList1[d]._id+";");for(let d=0;d<this.checkBoxList2.length;d++)this.checkBoxList2[d].isChecked&&(a=a+this.checkBoxList2[d]._id+";");for(let d=0;d<this.checkBoxList3.length;d++)this.checkBoxList3[d].isChecked&&(s=s+this.checkBoxList3[d]._id+";");const T={estructura:{usuarioup:this.userinfo[0].email,idempresa:this.userinfo[0].idempresa._id,idpapa:this.itemactual.idpapa,geoposicion:this.geoposiciontxt,estado:e,fechaasignada:this.itemactual.fechaasignada,idcontrato:this.itemactual.idcontrato,idempresa0:this.itemactual.idempresa0,idinspector:this.itemactual.idinspector,idinspector0:this.itemactual.idinspector0,idperiodo:this.itemactual.idperiodo,idplanifica:this.itemactual.idplanifica,idproyecto:this.itemactual.idproyecto,idproyecto0:this.itemactual.idproyecto0,idsupervisor:this.itemactual.idsupervisor,idsupervisor0:this.itemactual.idsupervisor0,inspector:this.itemactual.idinspector,nombre:this.itemactual.nombre,novisita:this.itemactual.novisita,periodo:this.itemactual.periodo,proyecto:this.itemactual.proyecto,supervisor:this.itemactual.supervisor,verificapersonal:i,verificavehiculos:s,verificaherramienta:a,comentariopersonal:this.Form.controls.comentariopersonas.value,comentariovehiculos:this.Form.controls.comentariovehiculos.value,comentarioherramienta:this.Form.controls.comentarioherramientas.value},idcat:"PLANIFICACI\xd3N",idform:"5f81d95fc07d6532900465a4",idpapa:"5f81cd8ac07d6532900465a2",tipo:"detalle",tipo2:"Repositorio",ejecuta:"visitas_programadas",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Actualiza",accion:"Actualiza en formulario movil"}};T&&this.authenticationService.createRegmovil(this.itemactual._id,T,"frmmovils").then(d=>{this.authenticationService.retornatareas(),this.location.back()},d=>{this.authenticationService.presentAlert(d.error,"Precauci\xf3n","")})}}return u.\u0275fac=function(e){return new(e||u)(t.Y36(f.Ye),t.Y36(b.F0),t.Y36(n.Br),t.Y36(n.IN),t.Y36(M.sK),t.Y36(U.$),t.Y36(n.BX))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-frmtareasprogramadas-create"]],viewQuery:function(e,i){if(1&e&&(t.Gf(F,5),t.Gf(N,7)),2&e){let a;t.iGM(a=t.CRH())&&(i.inputElement=a.first),t.iGM(a=t.CRH())&&(i.fotoa=a.first)}},decls:59,vars:13,consts:[[1,"create-user-form","ion-page",3,"formGroup"],["color","primary"],["slot","start"],["defaultHref","frmtareasprogramadasListPage"],["size","small"],["collapse","true","slot","end"],["title","Monitoreo",3,"click"],["slot","icon-only","name","images-outline"],["title","Ordenes de campo",3,"click"],["slot","icon-only","name","albums-outline"],[1,"create-form-content"],[1,"ion-padding"],["color","medium"],[3,"innerHtml"],["color","danger"],[1,"ion-text-wrap"],[1,"ion-no-margin"],["class","ionic-selectable-item","button","true","detail","false",4,"ngFor","ngForOf"],[1,"input-item"],["position","floating"],["inputMode","text","rows","4","clearInput","true","formControlName","comentariopersonas"],["inputMode","text","rows","4","clearInput","true","formControlName","comentariovehiculos"],["inputMode","text","rows","4","clearInput","true","formControlName","comentarioherramientas"],[1,"form-actions-wrapper"],[3,"hidden",4,"ngIf"],["button","true","detail","false",1,"ionic-selectable-item"],["size","2"],["ionImgViewer","","scheme","dark",3,"src",4,"ngIf"],["slot","start",3,"ngModel","ngModelOptions","ngModelChange","ionChange"],["ionImgViewer","","scheme","dark",3,"src"],[3,"hidden"],["color","primary","expand","block","type","submit",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.TgZ(1,"ion-header"),t.TgZ(2,"ion-toolbar",1),t.TgZ(3,"ion-buttons",2),t._UZ(4,"ion-back-button",3),t.qZA(),t.TgZ(5,"ion-title",4),t._uU(6,"Revisar Visita programada"),t.qZA(),t.TgZ(7,"ion-buttons",5),t.TgZ(8,"ion-button",6),t.NdJ("click",function(){return i.fotovisita()}),t._UZ(9,"ion-icon",7),t.qZA(),t.TgZ(10,"ion-button",8),t.NdJ("click",function(){return i.serviciovisita()}),t._UZ(11,"ion-icon",9),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"ion-content",10),t.TgZ(13,"div",11),t.TgZ(14,"h1"),t._uU(15),t.ALo(16,"date"),t.qZA(),t.TgZ(17,"h1"),t._uU(18),t.qZA(),t.TgZ(19,"p"),t._uU(20),t.qZA(),t.TgZ(21,"ion-text",12),t._UZ(22,"div",13),t.qZA(),t.qZA(),t.TgZ(23,"ion-item-divider",14),t.TgZ(24,"ion-label",15),t._uU(25),t.qZA(),t.qZA(),t.TgZ(26,"ion-list",16),t.YNc(27,L,26,9,"ion-item",17),t.qZA(),t.TgZ(28,"ion-item",18),t.TgZ(29,"ion-label",19),t._uU(30,"Comentarios verificaci\xf3n de personas"),t.TgZ(31,"ion-text",14),t._uU(32,"*"),t.qZA(),t.qZA(),t._UZ(33,"ion-textarea",20),t.qZA(),t.TgZ(34,"ion-item-divider",14),t.TgZ(35,"ion-label",15),t._uU(36," Verificar Vehiculos de contrato actual "),t.qZA(),t.qZA(),t.TgZ(37,"ion-list",16),t.YNc(38,B,32,10,"ion-item",17),t.qZA(),t.TgZ(39,"ion-item",18),t.TgZ(40,"ion-label",19),t._uU(41,"Comentarios verificaci\xf3n de vehiculos"),t.TgZ(42,"ion-text",14),t._uU(43,"*"),t.qZA(),t.qZA(),t._UZ(44,"ion-textarea",21),t.qZA(),t.TgZ(45,"ion-item-divider",14),t.TgZ(46,"ion-label",15),t._uU(47," Verificar Herramientas de contrato actual "),t.qZA(),t.qZA(),t.TgZ(48,"ion-list",16),t.YNc(49,S,24,8,"ion-item",17),t.qZA(),t.TgZ(50,"ion-item",18),t.TgZ(51,"ion-label",19),t._uU(52,"Comentarios verificaci\xf3n de herramientas"),t.TgZ(53,"ion-text",14),t._uU(54,"*"),t.qZA(),t.qZA(),t._UZ(55,"ion-textarea",22),t.qZA(),t.qZA(),t.TgZ(56,"ion-footer"),t.TgZ(57,"ion-row",23),t.YNc(58,R,3,2,"ion-col",24),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.Q6J("formGroup",i.Form),t.xp6(15),t.hij("Fecha programada: ",t.xi3(16,10,i.itemactual.fechaasignada,"dd-MM-yyyy"),""),t.xp6(3),t.hij("Estado: ",i.itemactual.estado,""),t.xp6(2),t.hij("No visita: ",i.itemactual.novisita,""),t.xp6(2),t.Q6J("innerHtml",i.itemactual.nombre,t.oJD),t.xp6(3),t.hij(" Verificar Personas de contrato actual (JORNADA: ",i.tipojornada,") "),t.xp6(2),t.Q6J("ngForOf",i.checkBoxList1),t.xp6(11),t.Q6J("ngForOf",i.checkBoxList3),t.xp6(11),t.Q6J("ngForOf",i.checkBoxList2),t.xp6(9),t.Q6J("ngIf","activa"===i.estadoxxx))},directives:[_._Y,_.JL,_.sg,n.Gu,n.sr,n.Sm,n.oU,n.cs,n.wd,n.YG,n.gu,n.W2,n.yW,n.rH,n.Q$,n.q_,f.sg,n.Ie,n.g2,n.j9,_.JJ,_.u,n.fr,n.Nd,f.O5,n.wI,n.ho,n.w,_.On,n.Xz,y.Bg],pipes:[f.uU],styles:["[_nghost-%COMP%]{--page-margin: var(--app-fair-margin);--page-background: var(--app-background);--page-background-shade: var(--app-background-shade);--page-tags-gutter: 5px}ion-item[_ngcontent-%COMP%]{--inner-padding-end: 0;--background: transparent}ion-toggle[_ngcontent-%COMP%]{width:80px;height:40px}ion-label[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px}ion-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:600}ion-item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{float:right;align-items:center;display:flex}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:42px;margin-right:8px}ion-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:15px;margin-right:12px;font-weight:400}h1[_ngcontent-%COMP%]{margin:0;font-weight:700;font-size:22px}p[_ngcontent-%COMP%]{line-height:22px}.show-favorite[_ngcontent-%COMP%]{position:relative}.icon-heart-empty[_ngcontent-%COMP%], .icon-heart[_ngcontent-%COMP%]{--border-radius: 50%;--padding-start: 0;--padding-end: 0;position:absolute;top:5px;right:5px;width:48px;height:48px;font-size:16px;transition:transform .3s ease}.icon-heart-empty[_ngcontent-%COMP%]{transform:scale(1)}.icon-heart[_ngcontent-%COMP%]{transform:scale(0)}.show-favorite[_ngcontent-%COMP%]   .icon-heart[_ngcontent-%COMP%]{transform:scale(1)}.show-favorite[_ngcontent-%COMP%]   .icon-heart-empty[_ngcontent-%COMP%]{transform:scale(0)}h1[_ngcontent-%COMP%]{margin:0}"]}),u})(),D=(()=>{class u{}return u.\u0275fac=function(e){return new(e||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({imports:[[f.ez,n.Pc,o.K,_.u5,_.UX,y.YL,b.Bz.forChild([{path:"",component:j}]),M.aw.forChild()]]}),u})()},63814:(I,P,c)=>{c.d(P,{B:()=>y});var n=c(70655),b=c(47423),f=c(96090),o=c(5e3),M=c(23349);const _=["search"];let y=(()=>{class A{constructor(l,p,Z){this.modalController=l,this.ngZone=p,this.navParams=Z,this.title="AGM project",this.zoom=16}dismissModal(){this.modalController.dismiss("close")}dadireccion(){this.modalController.dismiss({direccion:this.address,la:this.latitude,lo:this.longitude})}ngOnInit(){this.uubx=this.navParams.get("uubx")}loadMap(){}clearWatch(){null!=this.watchId&&f.b.clearWatch({id:this.watchId})}setCurrentLocationa33(){if(b.dV.isPluginAvailable("Geolocation"))try{this.watchId=f.b.watchPosition({timeout:1e3,enableHighAccuracy:!0,maximumAge:1e3},(l,p)=>{l&&(this.latitude=l.coords.latitude,this.longitude=l.coords.longitude)})}catch(l){console.error(l)}}setCurrentLocationa(){try{this.watchId=f.b.watchPosition({timeout:1e3,enableHighAccuracy:!0,maximumAge:1e3},(l,p)=>{l&&(this.latitude=l.coords.latitude,this.longitude=l.coords.longitude,this.getAddress(this.latitude,this.longitude))})}catch(l){console.error(l)}}setCurrentLocation2a(){if(b.dV.isPluginAvailable("Geolocation"))try{this.watchId=f.b.watchPosition({timeout:1e3,enableHighAccuracy:!0,maximumAge:1e3},(l,p)=>{this.latitude=Number(this.uubx.substring(this.uubx.indexOf("{")+1,this.uubx.indexOf("\xb0"))),this.longitude=Number(this.uubx.substring(this.uubx.indexOf("\xb0")+1,this.uubx.indexOf("}"))),0!==this.latitude&&this.latitude&&this.getAddress(this.latitude,this.longitude)})}catch(l){console.error(l)}}markerDragEnd(l){0!==this.latitude&&this.latitude&&(this.latitude=l.coords.lat,this.longitude=l.coords.lng,this.getAddress(this.latitude,this.longitude))}getAddress(l,p){this.geoCoder.geocode({location:{lat:l,lng:p}},(Z,t)=>{"OK"===t?Z[0]?this.address=Z[0].formatted_address:window.alert("No results found"):window.alert("Geocoder failed due to: "+t)})}closeModal(){return(0,n.mG)(this,void 0,void 0,function*(){this.modalController.dismiss("close")})}}return A.\u0275fac=function(l){return new(l||A)(o.Y36(M.IN),o.Y36(o.R0b),o.Y36(M.X1))},A.\u0275cmp=o.Xpm({type:A,selectors:[["app-my-modal"]],viewQuery:function(l,p){if(1&l&&o.Gf(_,5),2&l){let Z;o.iGM(Z=o.CRH())&&(p.searchElementRef=Z.first)}},decls:19,vars:6,consts:[[3,"translucent"],["color","primary"],["shape","round","color","dark",3,"click"],["slot","start","name","locate"],["collapse","true","slot","end"],[3,"click"],["slot","icon-only","name","close"],["size","small"],[1,"ion-padding",3,"fullscreen"],["id","book-search-input","role","search"],["type","text","placeholder","Ingrese direcci\xf3n","autocorrect","off","autocapitalize","off","spellcheck","off","type","text",1,"book-search-input","native-input","sc-ion-input-ios",3,"keydown.enter"],["search",""],["type","submit","expand","block",1,"login-btn",3,"click"]],template:function(l,p){1&l&&(o.TgZ(0,"ion-header",0),o.TgZ(1,"ion-toolbar",1),o.TgZ(2,"ion-button",2),o.NdJ("click",function(){return p.loadMap()}),o._UZ(3,"ion-icon",3),o._uU(4," Ubicaci\xf3n "),o.qZA(),o.TgZ(5,"ion-buttons",4),o.TgZ(6,"ion-button",5),o.NdJ("click",function(){return p.closeModal()}),o._UZ(7,"ion-icon",6),o.qZA(),o.qZA(),o.TgZ(8,"ion-title",7),o._uU(9),o.qZA(),o.qZA(),o.qZA(),o.TgZ(10,"ion-content",8),o._uU(11),o.TgZ(12,"div",9),o.TgZ(13,"input",10,11),o.NdJ("keydown.enter",function(t){return t.preventDefault()}),o.qZA(),o.qZA(),o.TgZ(15,"h5"),o._uU(16),o.qZA(),o.TgZ(17,"ion-button",12),o.NdJ("click",function(){return p.dadireccion()}),o._uU(18,"Seleccionar"),o.qZA(),o.qZA()),2&l&&(o.Q6J("translucent",!0),o.xp6(9),o.Oqu(p.tituloxx),o.xp6(1),o.Q6J("fullscreen",!0),o.xp6(1),o.AsE("\n",p.latitude,", ",p.longitude," "),o.xp6(5),o.hij("Direcci\xf3n: ",p.address,""))},directives:[M.Gu,M.sr,M.YG,M.gu,M.Sm,M.wd,M.W2],styles:[".book-search-input[_ngcontent-%COMP%]{padding:6px;background:0 0;transition:top .5s ease;background:#bdbaba;border-bottom:1px solid rgba(0,0,0,.07);border-top:1px solid rgba(0,0,0,.07);margin-bottom:10px;margin-top:-1px;color:#fff;width:100%}"]}),A})()}}]);