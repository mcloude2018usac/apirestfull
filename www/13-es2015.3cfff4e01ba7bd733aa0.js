(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"0rIg":function(n,l,t){"use strict";t.d(l,"a",(function(){return e}));class e{}},"7YSU":function(n,l,t){"use strict";t.d(l,"a",(function(){return p}));var e=t("8Y7J"),i=t("MKJQ"),o=t("sZkV"),a=t("s7LF"),r=t("SVse"),s=t("Gs+c"),u=t("TSSN"),c=t("ZtEv"),h=e.wb({encapsulation:0,styles:[[".book-search-input[_ngcontent-%COMP%]{padding:6px;background:0 0;transition:top .5s ease;background:#bdbaba;border-bottom:1px solid rgba(0,0,0,.07);border-top:1px solid rgba(0,0,0,.07);margin-bottom:10px;margin-top:-1px;color:#fff;width:100%}ion-header[_ngcontent-%COMP%]{background:#4caf50}ion-title[_ngcontent-%COMP%]{text-align:center}ion-grid.cardON2[_ngcontent-%COMP%]{background-color:#606163;border-radius:10px;padding:10px;margin-bottom:15px;max-width:400px!important}ion-grid.cardON2[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{background-color:#414142}ion-grid.cardON[_ngcontent-%COMP%]{background-color:#4284ff;border-radius:10px;padding:10px;margin-bottom:15px;max-width:400px!important}ion-grid.cardON[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{background-color:#679cff}ion-grid.cardOFF[_ngcontent-%COMP%]{background-color:#bbb7b7;border-radius:10px;padding:10px;margin-bottom:15px;max-width:400px!important}ion-grid.cardOFF[_ngcontent-%COMP%]   .msg[_ngcontent-%COMP%]{background-color:#d4d4d4}.msg[_ngcontent-%COMP%]{float:left;padding:5px 8px;font-size:.8em;color:#fff;border-radius:5px}.number[_ngcontent-%COMP%]{color:#fff;font-size:1.5em;line-height:2em;text-align:center}.digits[_ngcontent-%COMP%]{padding-right:5%;padding-left:5%}.bank[_ngcontent-%COMP%], .date[_ngcontent-%COMP%]{color:#fff;font-size:.8em}.bank[_ngcontent-%COMP%]{text-align:right}.ON[_ngcontent-%COMP%]{background-color:#8de278}.OFF[_ngcontent-%COMP%], .ON[_ngcontent-%COMP%]{height:8px;width:8px;border-radius:50%;display:inline-block;margin-right:2px}.OFF[_ngcontent-%COMP%]{background-color:#fb5f5f}.brand[_ngcontent-%COMP%]{max-width:40%;float:right}.chip[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{max-width:50px;padding-top:5%;border-radius:10%!important;overflow:hidden}ion-icon#power[_ngcontent-%COMP%]{font-size:2em}"]],data:{}});function d(n){return e.ac(0,[(n()(),e.yb(0,0,null,null,48,"ion-item",[],null,null,null,i.Pb,i.A)),e.xb(1,49152,null,0,o.I,[e.h,e.l,e.z],null,null),(n()(),e.yb(2,0,null,0,42,"ion-grid",[],[[2,"cardON",null]],null,null,i.Db,i.t)),e.xb(3,49152,null,0,o.B,[e.h,e.l,e.z],null,null),(n()(),e.yb(4,0,null,0,9,"ion-row",[],null,null,null,i.ac,i.Q)),e.xb(5,49152,null,0,o.hb,[e.h,e.l,e.z],null,null),(n()(),e.yb(6,0,null,0,4,"ion-col",[["class","state"]],null,null,null,i.xb,i.n)),e.xb(7,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.yb(8,0,null,0,2,"div",[["class","msg"]],null,null,null,null,null)),(n()(),e.yb(9,0,null,null,0,"span",[],[[2,"ON",null],[2,"OFF",null]],null,null,null,null)),(n()(),e.Xb(10,null,[" "," "])),(n()(),e.yb(11,0,null,0,2,"ion-col",[["class","bank"]],null,null,null,i.xb,i.n)),e.xb(12,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.Xb(13,0,[" "," "])),(n()(),e.yb(14,0,null,0,8,"ion-row",[],null,null,null,i.ac,i.Q)),e.xb(15,49152,null,0,o.hb,[e.h,e.l,e.z],null,null),(n()(),e.yb(16,0,null,0,3,"ion-col",[["class","chip"],["size","2"]],null,null,null,i.xb,i.n)),e.xb(17,49152,null,0,o.u,[e.h,e.l,e.z],{size:[0,"size"]},null),(n()(),e.yb(18,0,null,0,1,"ion-img",[["src","assets/img/chip.png"]],null,null,null,i.Gb,i.w)),e.xb(19,49152,null,0,o.E,[e.h,e.l,e.z],{src:[0,"src"]},null),(n()(),e.yb(20,0,null,0,2,"ion-col",[["class","number3"],["size","10"]],null,null,null,i.xb,i.n)),e.xb(21,49152,null,0,o.u,[e.h,e.l,e.z],{size:[0,"size"]},null),(n()(),e.Xb(22,0,[" "," "])),(n()(),e.yb(23,0,null,0,13,"ion-row",[["class","digits"]],null,null,null,i.ac,i.Q)),e.xb(24,49152,null,0,o.hb,[e.h,e.l,e.z],null,null),(n()(),e.yb(25,0,null,0,2,"ion-col",[["class","number"]],null,null,null,i.xb,i.n)),e.xb(26,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.Xb(-1,0,[" **** "])),(n()(),e.yb(28,0,null,0,2,"ion-col",[["class","number"]],null,null,null,i.xb,i.n)),e.xb(29,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.Xb(-1,0,[" **** "])),(n()(),e.yb(31,0,null,0,2,"ion-col",[["class","number"]],null,null,null,i.xb,i.n)),e.xb(32,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.Xb(-1,0,[" **** "])),(n()(),e.yb(34,0,null,0,2,"ion-col",[["class","number"]],null,null,null,i.xb,i.n)),e.xb(35,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.Xb(36,0,[" "," "])),(n()(),e.yb(37,0,null,0,7,"ion-row",[],null,null,null,i.ac,i.Q)),e.xb(38,49152,null,0,o.hb,[e.h,e.l,e.z],null,null),(n()(),e.yb(39,0,null,0,2,"ion-col",[["class","date"]],null,null,null,i.xb,i.n)),e.xb(40,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.Xb(41,0,[" Expira: "," / "," "])),(n()(),e.yb(42,0,null,0,2,"ion-col",[["class","bank"]],null,null,null,i.xb,i.n)),e.xb(43,49152,null,0,o.u,[e.h,e.l,e.z],null,null),(n()(),e.Xb(44,0,[" "," "])),(n()(),e.yb(45,0,null,0,3,"ion-radio",[["color","success"],["slot","start"]],null,[[null,"ionBlur"],[null,"ionSelect"]],(function(n,l,t){var i=!0;return"ionBlur"===l&&(i=!1!==e.Nb(n,48)._handleBlurEvent(t.target)&&i),"ionSelect"===l&&(i=!1!==e.Nb(n,48)._handleIonSelect(t.target)&&i),i}),i.Yb,i.N)),e.Sb(5120,null,a.m,(function(n){return[n]}),[o.Mb]),e.xb(47,49152,null,0,o.Y,[e.h,e.l,e.z],{color:[0,"color"],value:[1,"value"]},null),e.xb(48,16384,null,0,o.Mb,[e.l],null,null)],(function(n,l){n(l,17,0,"2"),n(l,19,0,"assets/img/chip.png"),n(l,21,0,"10"),n(l,47,0,"success",l.context.$implicit._id)}),(function(n,l){var t=l.component;n(l,2,0,"Activo"),n(l,9,0,"Activo"==l.context.$implicit.estado,"Inactivo"==l.context.$implicit.estado),n(l,10,0,l.context.$implicit.estado),n(l,13,0,l.context.$implicit.banco),n(l,22,0,l.context.$implicit.nombre),n(l,36,0,t.padLeadingZeros(t.authenticationService.decryptvalue(l.context.$implicit.n4))),n(l,41,0,l.context.$implicit.mes,l.context.$implicit.ano),n(l,44,0,l.context.$implicit.tipo)}))}function b(n){return e.ac(0,[e.Tb(671088640,1,{radioGroup:0}),e.Tb(671088640,2,{searchElementRef:0}),(n()(),e.yb(2,0,null,null,12,"ion-header",[],null,null,null,i.Eb,i.u)),e.xb(3,49152,null,0,o.C,[e.h,e.l,e.z],{translucent:[0,"translucent"]},null),(n()(),e.yb(4,0,null,0,10,"ion-toolbar",[["color","primary"]],null,null,null,i.sc,i.ib)),e.xb(5,49152,null,0,o.Ab,[e.h,e.l,e.z],{color:[0,"color"]},null),(n()(),e.yb(6,0,null,0,5,"ion-buttons",[["slot","end"]],null,null,null,i.pb,i.f)),e.xb(7,49152,null,0,o.m,[e.h,e.l,e.z],null,null),(n()(),e.yb(8,0,null,0,3,"ion-button",[],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.closeModal()&&e),e}),i.ob,i.e)),e.xb(9,49152,null,0,o.l,[e.h,e.l,e.z],null,null),(n()(),e.yb(10,0,null,0,1,"ion-icon",[["name","close"],["slot","icon-only"]],null,null,null,i.Fb,i.v)),e.xb(11,49152,null,0,o.D,[e.h,e.l,e.z],{name:[0,"name"]},null),(n()(),e.yb(12,0,null,0,2,"ion-title",[],null,null,null,i.qc,i.gb)),e.xb(13,49152,null,0,o.yb,[e.h,e.l,e.z],null,null),(n()(),e.Xb(14,0,["",""])),(n()(),e.yb(15,0,null,null,32,"ion-content",[["class","ion-padding"]],null,null,null,i.yb,i.o)),e.xb(16,49152,null,0,o.v,[e.h,e.l,e.z],{fullscreen:[0,"fullscreen"]},null),(n()(),e.yb(17,0,null,0,4,"ion-item-divider",[["color","primary"]],null,null,null,i.Kb,i.B)),e.xb(18,49152,null,0,o.J,[e.h,e.l,e.z],{color:[0,"color"]},null),(n()(),e.yb(19,0,null,0,2,"ion-label",[],null,null,null,i.Qb,i.G)),e.xb(20,49152,null,0,o.O,[e.h,e.l,e.z],null,null),(n()(),e.Xb(-1,0,[" Canal de pago "])),(n()(),e.yb(22,0,null,0,22,"ion-list",[],null,null,null,i.Sb,i.H)),e.xb(23,49152,null,0,o.P,[e.h,e.l,e.z],null,null),(n()(),e.yb(24,0,null,0,20,"ion-radio-group",[["value","efectivo"]],null,[[null,"ionBlur"],[null,"ionChange"]],(function(n,l,t){var i=!0;return"ionBlur"===l&&(i=!1!==e.Nb(n,27)._handleBlurEvent(t.target)&&i),"ionChange"===l&&(i=!1!==e.Nb(n,27)._handleChangeEvent(t.target)&&i),i}),i.Xb,i.O)),e.Sb(5120,null,a.m,(function(n){return[n]}),[o.Ob]),e.xb(26,49152,null,0,o.Z,[e.h,e.l,e.z],{value:[0,"value"]},null),e.xb(27,16384,null,0,o.Ob,[e.l],null,null),(n()(),e.yb(28,0,null,0,16,"div",[],null,null,null,null,null)),(n()(),e.yb(29,0,null,null,15,"ion-radio-group",[["allow-empty-selection","true"],["name","radio-group"]],null,[[null,"ionChange"],[null,"ionBlur"]],(function(n,l,t){var i=!0,o=n.component;return"ionBlur"===l&&(i=!1!==e.Nb(n,32)._handleBlurEvent(t.target)&&i),"ionChange"===l&&(i=!1!==e.Nb(n,32)._handleChangeEvent(t.target)&&i),"ionChange"===l&&(i=!1!==o.radioSelect(t)&&i),i}),i.Xb,i.O)),e.Sb(5120,null,a.m,(function(n){return[n]}),[o.Ob]),e.xb(31,49152,[[1,4],["radioGroup",4]],0,o.Z,[e.h,e.l,e.z],{name:[0,"name"]},null),e.xb(32,16384,null,0,o.Ob,[e.l],null,null),(n()(),e.yb(33,0,null,0,9,"ion-item",[],null,null,null,i.Pb,i.A)),e.xb(34,49152,null,0,o.I,[e.h,e.l,e.z],null,null),(n()(),e.yb(35,0,null,0,3,"ion-label",[],null,null,null,i.Qb,i.G)),e.xb(36,49152,null,0,o.O,[e.h,e.l,e.z],null,null),(n()(),e.yb(37,0,null,0,1,"strong",[],null,null,null,null,null)),(n()(),e.Xb(-1,null,["Saldo actual"])),(n()(),e.yb(39,0,null,0,3,"ion-radio",[["color","success"],["slot","start"],["value","efectivo"]],null,[[null,"ionBlur"],[null,"ionSelect"]],(function(n,l,t){var i=!0;return"ionBlur"===l&&(i=!1!==e.Nb(n,42)._handleBlurEvent(t.target)&&i),"ionSelect"===l&&(i=!1!==e.Nb(n,42)._handleIonSelect(t.target)&&i),i}),i.Yb,i.N)),e.Sb(5120,null,a.m,(function(n){return[n]}),[o.Mb]),e.xb(41,49152,null,0,o.Y,[e.h,e.l,e.z],{color:[0,"color"],value:[1,"value"]},null),e.xb(42,16384,null,0,o.Mb,[e.l],null,null),(n()(),e.hb(16777216,null,0,1,null,d)),e.xb(44,278528,null,0,r.l,[e.P,e.M,e.s],{ngForOf:[0,"ngForOf"]},null),(n()(),e.yb(45,0,null,0,2,"ion-button",[["color","primary"],["expand","block"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.pagar()&&e),e}),i.ob,i.e)),e.xb(46,49152,null,0,o.l,[e.h,e.l,e.z],{color:[0,"color"],expand:[1,"expand"]},null),(n()(),e.Xb(-1,0,[" PAGAR "]))],(function(n,l){var t=l.component;n(l,3,0,!0),n(l,5,0,"primary"),n(l,11,0,"close"),n(l,16,0,!0),n(l,18,0,"primary"),n(l,26,0,"efectivo"),n(l,31,0,"radio-group"),n(l,41,0,"success","efectivo"),n(l,44,0,t.items),n(l,46,0,"primary","block")}),(function(n,l){n(l,14,0,l.component.tituloxx)}))}function m(n){return e.ac(0,[(n()(),e.yb(0,0,null,null,1,"app-my-modalcredito",[],null,null,null,b,h)),e.xb(1,4308992,null,0,s.a,[u.l,o.Gb,c.a,o.Ib],null,null)],(function(n,l){n(l,1,0)}),null)}var p=e.ub("app-my-modalcredito",s.a,m,{},{},[])},"Gs+c":function(n,l,t){"use strict";t.d(l,"a",(function(){return i}));var e=t("mrSG");t("ZtEv");class i{constructor(n,l,t,e){this.translateService=n,this.modalController=l,this.authenticationService=t,this.navParams=e,this.title="AGM project",this.items2=[],this.msg="",this.userinfo=[],this.items=[],this.defaultSelectedRadio="efectivo",this.userinfo=this.authenticationService.getcopiauser(),this.passcode="",this.finalPin="",this.mypinseguro=this.userinfo[0].codpersonal,this.message=!0,this.pageStatus="Enter Pin",this.int=0,this.newPincount=0,this.fingerPin=!1}padLeadingZeros(n,l){let t=n+"";for(;t.length<l;)t="0"+t;return t}ngOnInit(){this.tituloxx=this.navParams.get("title"),this.metodopago=this.navParams.get("metodopago"),this.userinfo=this.authenticationService.getcopiauser(),this.translateService.get("SEGUROM").subscribe(n=>{this.seguro=n}),this.translateService.get("MSGM").subscribe(n=>{this.msg=n}),this.pideregistros("Activo")}ngAfterViewInit(){setTimeout(()=>{this.selectTwo()},400)}pagar(){this.modalController.dismiss({data:this.metodopago,item:this.tpagoid})}closeModal(){return Object(e.a)(this,void 0,void 0,(function*(){this.modalController.dismiss({data:"close"})}))}selectTwo(){this.radioGroup.value="efectivo"}pideregistros(n){this.itemsList=[],this.authenticationService.getReg("todos/"+n+"/"+this.userinfo[0].idempresa._id+"/"+this.userinfo[0]._id,"tarjetacreditos",0).then(n=>{this.items=n,this.itemsList=this.items},n=>{this.authenticationService.presentAlert(n.error,this.msg,"")})}radioSelect(n){this.tpagoid=n.detail.value}}},KyMZ:function(n,l,t){"use strict";t.d(l,"a",(function(){return e}));class e{}},OEUh:function(n,l,t){"use strict";t.d(l,"a",(function(){return p}));var e=t("8Y7J"),i=t("MKJQ"),o=t("sZkV"),a=t("SVse"),r=t("fc4l"),s=t("ZtEv"),u=e.wb({encapsulation:0,styles:[["[_nghost-%COMP%]{--page-margin:var(--app-fair-margin);--page-background:var(--app-background);--page-swiper-pagination-space:30px;--page-swiper-pagination-height:18px;--page-pagination-bullet-size:10px;--page-options-gutter:calc(var(--page-margin)/2);--page-related-items-gutter:calc(var(--page-margin)/2);--page-color:#089bdf}.book-search-input[_ngcontent-%COMP%]{padding:6px;background:0 0;transition:top .5s ease;background:#bdbaba;border-bottom:1px solid rgba(0,0,0,.07);border-top:1px solid rgba(0,0,0,.07);margin-bottom:10px;margin-top:-1px;color:#fff;width:100%}.detail-title[_ngcontent-%COMP%]{font-size:22px;font-weight:500;color:var(--ion-color-dark-tint);margin:0;margin-bottom:calc(var(--page-margin)/2)}"]],data:{}});function c(n){return e.ac(0,[(n()(),e.yb(0,0,null,null,3,"ion-button",[["color","danger"],["title","Parar escaner"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.stopScan()&&e),e}),i.ob,i.e)),e.xb(1,49152,null,0,o.l,[e.h,e.l,e.z],{color:[0,"color"]},null),(n()(),e.yb(2,0,null,0,1,"ion-icon",[["name","stop-circle-outline"],["slot","start"]],null,null,null,i.Fb,i.v)),e.xb(3,49152,null,0,o.D,[e.h,e.l,e.z],{name:[0,"name"]},null)],(function(n,l){n(l,1,0,"danger"),n(l,3,0,"stop-circle-outline")}),null)}function h(n){return e.ac(0,[(n()(),e.yb(0,0,null,null,3,"ion-button",[["color","warning"],["title","Reset"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.reset()&&e),e}),i.ob,i.e)),e.xb(1,49152,null,0,o.l,[e.h,e.l,e.z],{color:[0,"color"]},null),(n()(),e.yb(2,0,null,0,1,"ion-icon",[["name","refresh-circle-outline"],["slot","start"]],null,null,null,i.Fb,i.v)),e.xb(3,49152,null,0,o.D,[e.h,e.l,e.z],{name:[0,"name"]},null)],(function(n,l){n(l,1,0,"warning"),n(l,3,0,"refresh-circle-outline")}),null)}function d(n){return e.ac(0,[(n()(),e.yb(0,0,null,null,4,"h3",[["class","detail-title"]],null,null,null,null,null)),(n()(),e.Xb(-1,null,["Monto a cobrar: "])),(n()(),e.yb(2,0,null,null,2,"strong",[],null,null,null,null,null)),(n()(),e.Xb(3,null,[" ",""])),e.Rb(4,2)],null,(function(n,l){var t=l.component,i=e.Yb(l,3,0,n(l,4,0,e.Nb(l.parent,0),t.monto,t.moneda));n(l,3,0,i)}))}function b(n){return e.ac(0,[e.Pb(0,a.d,[e.u,e.k]),e.Tb(671088640,1,{video:0}),e.Tb(671088640,2,{canvas:0}),e.Tb(671088640,3,{fileinput:0}),e.Tb(671088640,4,{searchElementRef:0}),(n()(),e.yb(5,0,null,null,24,"ion-header",[],null,null,null,i.Eb,i.u)),e.xb(6,49152,null,0,o.C,[e.h,e.l,e.z],{translucent:[0,"translucent"]},null),(n()(),e.yb(7,0,null,0,22,"ion-toolbar",[["color","primary"]],null,null,null,i.sc,i.ib)),e.xb(8,49152,null,0,o.Ab,[e.h,e.l,e.z],{color:[0,"color"]},null),(n()(),e.yb(9,0,null,0,17,"ion-buttons",[["slot","end"]],null,null,null,i.pb,i.f)),e.xb(10,49152,null,0,o.m,[e.h,e.l,e.z],null,null),(n()(),e.hb(16777216,null,0,1,null,c)),e.xb(12,16384,null,0,a.m,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.hb(16777216,null,0,1,null,h)),e.xb(14,16384,null,0,a.m,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.yb(15,0,null,0,3,"ion-button",[["title","Iniciar escaner"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.startScan()&&e),e}),i.ob,i.e)),e.xb(16,49152,null,0,o.l,[e.h,e.l,e.z],null,null),(n()(),e.yb(17,0,null,0,1,"ion-icon",[["name","qr-code-outline"],["slot","icon-only"]],null,null,null,i.Fb,i.v)),e.xb(18,49152,null,0,o.D,[e.h,e.l,e.z],{name:[0,"name"]},null),(n()(),e.yb(19,0,null,0,3,"ion-button",[["title","leer imagen qr de galeria"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.captureImage()&&e),e}),i.ob,i.e)),e.xb(20,49152,null,0,o.l,[e.h,e.l,e.z],null,null),(n()(),e.yb(21,0,null,0,1,"ion-icon",[["name","image-outline"],["slot","icon-only"]],null,null,null,i.Fb,i.v)),e.xb(22,49152,null,0,o.D,[e.h,e.l,e.z],{name:[0,"name"]},null),(n()(),e.yb(23,0,null,0,3,"ion-button",[],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.closeModal()&&e),e}),i.ob,i.e)),e.xb(24,49152,null,0,o.l,[e.h,e.l,e.z],null,null),(n()(),e.yb(25,0,null,0,1,"ion-icon",[["name","close"],["slot","icon-only"]],null,null,null,i.Fb,i.v)),e.xb(26,49152,null,0,o.D,[e.h,e.l,e.z],{name:[0,"name"]},null),(n()(),e.yb(27,0,null,0,2,"ion-title",[],null,null,null,i.qc,i.gb)),e.xb(28,49152,null,0,o.yb,[e.h,e.l,e.z],null,null),(n()(),e.Xb(29,0,["",""])),(n()(),e.yb(30,0,null,null,7,"ion-content",[["class","ion-padding"]],null,null,null,i.yb,i.o)),e.xb(31,49152,null,0,o.v,[e.h,e.l,e.z],{fullscreen:[0,"fullscreen"]},null),(n()(),e.yb(32,0,[[3,0],["fileinput",1]],0,0,"input",[["accept","image/*;capture=camera"],["hidden",""],["type","file"]],null,[[null,"change"]],(function(n,l,t){var e=!0;return"change"===l&&(e=!1!==n.component.handleFile(t.target.files)&&e),e}),null,null)),(n()(),e.yb(33,0,null,0,0,"br",[],null,null,null,null,null)),(n()(),e.hb(16777216,null,0,1,null,d)),e.xb(35,16384,null,0,a.m,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.yb(36,0,[[1,0],["video",1]],0,0,"video",[["width","100%"]],[[8,"hidden",0]],null,null,null,null)),(n()(),e.yb(37,0,[[2,0],["canvas",1]],0,0,"canvas",[["hidden",""]],null,null,null,null,null))],(function(n,l){var t=l.component;n(l,6,0,!0),n(l,8,0,"primary"),n(l,12,0,t.scanActive),n(l,14,0,t.scanResult),n(l,18,0,"qr-code-outline"),n(l,22,0,"image-outline"),n(l,26,0,"close"),n(l,31,0,!0),n(l,35,0,0!==t.monto)}),(function(n,l){var t=l.component;n(l,29,0,t.tituloxx),n(l,36,0,!t.scanActive)}))}function m(n){return e.ac(0,[(n()(),e.yb(0,0,null,null,1,"app-my-modalscanpay",[],null,null,null,b,u)),e.xb(1,4308992,null,0,r.a,[o.b,o.Gb,o.Eb,o.Qb,s.a,e.z,o.Ib,o.Kb],null,null)],(function(n,l){n(l,1,0)}),null)}var p=e.ub("app-my-modalscanpay",r.a,m,{},{},[])},fc4l:function(n,l,t){"use strict";t.d(l,"a",(function(){return a}));var e=t("mrSG"),i=(t("ZtEv"),t("7Ozu")),o=t.n(i);class a{constructor(n,l,t,e,i,o,a,r){this.alertController=n,this.modalController=l,this.loadingCtrl=t,this.toastCtrl=e,this.authenticationService=i,this.ngZone=o,this.navParams=a,this.plt=r,this.scanActive=!1,this.scanResult=null,this.loading=null,this.title="AGM project",this.zoom=16,this.userinfo=[],this.monto=0,this.plt.is("ios")&&"standalone"in window.navigator&&window}dismissModal(){this.modalController.dismiss({data:"close"})}ngOnInit(){this.userinfo=this.authenticationService.getcopiauser(),this.tituloxx=this.navParams.get("title"),this.moneda=this.navParams.get("moneda"),this.monto=this.navParams.get("monto"),this.tipo=this.navParams.get("tipo")}ngAfterViewInit(){this.canvasElement=this.canvas.nativeElement,this.canvasContext=this.canvasElement.getContext("2d"),this.videoElement=this.video.nativeElement,this.startScan()}showQrToast(){return Object(e.a)(this,void 0,void 0,(function*(){(yield this.toastCtrl.create({message:`Open ${this.scanResult}?`,position:"top",buttons:[{text:"Open",handler:()=>{window.open(this.scanResult,"_system","location=yes")}}]})).present()}))}reset(){this.scanResult=null}stopScan(){this.scanActive=!1}startScan(){return Object(e.a)(this,void 0,void 0,(function*(){const n=yield navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});this.videoElement.srcObject=n,this.videoElement.setAttribute("playsinline",!0),this.loading=yield this.loadingCtrl.create({}),yield this.loading.present(),this.videoElement.play(),requestAnimationFrame(this.scan.bind(this))}))}scan(){return Object(e.a)(this,void 0,void 0,(function*(){if(this.videoElement.readyState===this.videoElement.HAVE_ENOUGH_DATA){this.loading&&(yield this.loading.dismiss(),this.loading=null,this.scanActive=!0),this.canvasElement.height=this.videoElement.videoHeight,this.canvasElement.width=this.videoElement.videoWidth,this.canvasContext.drawImage(this.videoElement,0,0,this.canvasElement.width,this.canvasElement.height);const n=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),l=o()(n.data,n.width,n.height,{inversionAttempts:"dontInvert"});if(l){this.scanActive=!1,this.scanResult=this.authenticationService.decryptvalue(l.data);const n=this.scanResult.split("\xb0");this.tokenactual=n[6],"pagoqr"===this.tipo?this.verificapago(n):this.cobronormal(n)}else this.scanActive&&requestAnimationFrame(this.scan.bind(this))}else requestAnimationFrame(this.scan.bind(this))}))}captureImage(){this.fileinput.nativeElement.click()}handleFile(n){const l=n.item(0),t=new Image;t.onload=()=>{this.canvasContext.drawImage(t,0,0,this.canvasElement.width,this.canvasElement.height);const n=this.canvasContext.getImageData(0,0,this.canvasElement.width,this.canvasElement.height),l=o()(n.data,n.width,n.height,{inversionAttempts:"dontInvert"});if(l){this.scanResult=this.authenticationService.decryptvalue(l.data);const n=this.scanResult.split("\xb0");this.tokenactual=n[6],"cobrapagoqr"===this.tipo?this.cobronormalreves(n):"pagoqr"===this.tipo?this.verificapago(n):this.cobronormal(n)}},t.src=URL.createObjectURL(l)}verificapago(n){this.authenticationService.getReg(this.tokenactual+"/3","compratokens",0).then(l=>{let t=[];t=l,t.length>0?3===l[0].estado?this.cobronormalsinsaldo(n):0===l[0].estado?this.authenticationService.getReg(n[1]+"/personadispid/"+n[0],"personals",0).then(l=>{if(Number(l[0].saldo)>=Number(this.monto)){const l={estado:2,cobroservicio:this.userinfo[0].idempresa.nombre+"<br> en la ubicaci\xf3n:"+this.userinfo[0].idempresa.direccion+"<br> Quiere cobrar "+this.moneda+" "+this.monto+"<br> \xbf Desea autorizar la transaccion?",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Actualiza",accion:"acepta token "+this.tokenactual}};l&&this.authenticationService.createReg(this.tokenactual,l,"compratokens").then(l=>{this.StartTimer(n)},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})}else{const n={estado:10,cobroservicio:"Fondos insuficientes",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Actualiza",accion:"acepta token "+this.tokenactual}};n&&this.authenticationService.createReg(this.tokenactual,n,"compratokens").then(n=>{this.authenticationService.presentAlert("Fondos insuficientes","Precauci\xf3n","")},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})}},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")}):this.StartTimer(n):this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","")},n=>{this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","")})}StartTimer(n){this.timer=setTimeout(l=>{this.authenticationService.getReg(this.tokenactual+"/3","compratokens",0).then(l=>{let t=[];t=l,t.length>0&&3===l[0].estado?this.cobronormalsinsaldo(n):this.StartTimer(n)},n=>{this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","")})},3e3)}closeModal(){return Object(e.a)(this,void 0,void 0,(function*(){this.modalController.dismiss({data:"close"})}))}cobronormal(n){this.authenticationService.getReg(n[6]+"/2","compratokens",0).then(l=>{let t=[];if(t=l,t.length>0)if(0===l[0].estado)if(this.authenticationService.decryptvalue(t[0].trama)+"\xb0"+t[0]._id+"\xb0"+t[0].tipo===this.scanResult)if(this.monto===n[4]){const l={operacion:"pagaservicio",dservicio:"Cobro por pago de servicio",cservicio:"Cobro por servicio",nodispositivo:"servicio",noprov:"",idempresa:this.userinfo[0].idempresa._id,idsuscriptor:n[1],tipocompra:"servicio",tokencompra:t[0]._id,nombre:n[2],monto:this.monto,url:"",tpago:"Efectivo",estado:"Facturado",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Crea",accion:"Compra de saldo"},idempresa0:n[1],idsuscriptor2:{id:this.userinfo[0]._id,nombre:this.userinfo[0].nombre}};l&&this.authenticationService.createReg("",l,"comprasaldos").then(l=>{this.modalController.dismiss({data:"Se ha realizado una venta a: "+n[2]+"<br> Por un monto de "+this.moneda+" "+this.monto})},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})}else this.authenticationService.presentAlert("El Monto no coincide con lo que el cliente programo.<br> El cliente quiere comprar: "+this.moneda+" "+n[4]+"<br> Se quiere acreditar: "+this.moneda+" "+this.monto,"Precauci\xf3n","");else this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","");else this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","");else this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","")})}seguroacepta(n,l,t){return Object(e.a)(this,void 0,void 0,(function*(){const e=yield this.alertController.create({message:n,buttons:[{text:"No Aceptar",cssClass:"secondary",handler:n=>{const l={estado:33,cobroservicio:"Cliente no autorizo transaccion ",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Actualiza",accion:"acepta token "+this.tokenactual}};l&&this.authenticationService.createReg(this.tokenactual,l,"compratokens").then(n=>{this.modalController.dismiss("ok")},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})}},{text:"Aceptar",handler:()=>{var n=l[2].split("<");const e={operacion:"pagaservicio",dservicio:"Cobro por pago de servicio",cservicio:"Cobro por servicio",nodispositivo:"servicio",noprov:"",idempresa:l[0],idsuscriptor:this.userinfo[0]._id,tipocompra:"servicio",tokencompra:t[0]._id,nombre:this.userinfo[0].nombre,monto:l[4],url:"",tpago:"Efectivo",estado:"Facturado",bitacora:{idempresa:l[0],idafiliado:"",email:this.userinfo[0].email,permiso:"Crea",accion:"Cobro por pago de servicio"},idempresa0:this.userinfo[0]._id,idsuscriptor2:{id:l[1],nombre:n[0]}};e&&this.authenticationService.createReg("",e,"comprasaldos").then(n=>{const l={estado:33,cobroservicio:"Cobro realizado con exito ",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Actualiza",accion:"acepta token "+this.tokenactual}};l&&this.authenticationService.createReg(this.tokenactual,l,"compratokens").then(n=>{this.modalController.dismiss("ok")},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})},n=>{const l={estado:33,cobroservicio:"Cliente no autorizo transaccion ",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Actualiza",accion:"acepta token "+this.tokenactual}};l&&this.authenticationService.createReg(this.tokenactual,l,"compratokens").then(n=>{this.modalController.dismiss("ok")},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")}),this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})}}]});yield e.present()}))}cobronormalreves(n){this.authenticationService.getReg(n[6]+"/2","compratokens",0).then(l=>{let t=[];t=l,t.length>0&&0===l[0].estado&&this.authenticationService.decryptvalue(t[0].trama)+"\xb0"+t[0].tipo+"\xb0"+t[0]._id+"\xb0"+t[0].tipo===this.scanResult?this.seguroacepta(n[2]+"<br> Quiere cobrar "+this.moneda+" "+n[4]+"<br> \xbf Desea autorizar la transaccion?",n,t):this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","")})}cobronormalsinsaldo(n){this.authenticationService.getReg(n[1]+"/personadispid/"+n[0],"personals",0).then(l=>{if(Number(l[0].saldo)>=Number(this.monto))this.authenticationService.getReg(n[6]+"/2","compratokens",0).then(l=>{let t=[];t=l;const e={operacion:"pagaservicio",dservicio:"Cobro por pago de servicio",cservicio:"Cobro por servicio",nodispositivo:"servicio",noprov:"",idempresa:this.userinfo[0].idempresa._id,idsuscriptor:n[1],tipocompra:"servicio",tokencompra:t[0]._id,nombre:n[2],monto:this.monto,url:"",tpago:"Efectivo",estado:"Facturado",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Crea",accion:"Compra de saldo"},idempresa0:n[1],idsuscriptor2:{id:this.userinfo[0]._id,nombre:this.userinfo[0].nombre}};e&&this.authenticationService.createReg("",e,"comprasaldos").then(l=>{this.modalController.dismiss({data:"Se ha realizado una venta a: "+n[2]+"<br> Por un monto de "+this.moneda+" "+this.monto})},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})},n=>{this.authenticationService.presentAlert("Transacci\xf3n insegura","Precauci\xf3n","")});else{const n={estado:100,cobroservicio:"Fondos insuficientes, transaccion anulada",bitacora:{idempresa:this.userinfo[0].idempresa._id,idafiliado:"",email:this.userinfo[0].email,permiso:"Actualiza",accion:"acepta token "+this.tokenactual}};n&&this.authenticationService.createReg(this.tokenactual,n,"compratokens").then(n=>{this.authenticationService.presentAlert("Fondos insuficientes, transaccion anulada","Precauci\xf3n","")},n=>{this.authenticationService.presentAlert(n.error,"Precauci\xf3n","")})}})}}}}]);